(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const l of e)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function o(e){const l={};return e.integrity&&(l.integrity=e.integrity),e.referrerPolicy&&(l.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?l.credentials="include":e.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(e){if(e.ep)return;e.ep=!0;const l=o(e);fetch(e.href,l)}})();const v=new DOMParser,p=new XSLTProcessor,B=new XMLSerializer,s={xml:null,result:null},m=document.getElementById("outXML"),S=document.getElementById("outXSLT"),x=document.getElementById("codeXML"),E=document.getElementById("codeXSLT"),F=document.querySelectorAll("input"),h=document.getElementById("xml"),L=document.getElementById("xsltBtn"),O=document.getElementById("convert");F.forEach(t=>t.addEventListener("change",()=>{s.xml=null,s.result=null,x.style.opacity=0,E.style.opacity=0,m.style.display="none";const{present:n}=w();O.disabled=!n,b(!0)}));function T(t,n){const o=v.parseFromString(n,"application/xml");return p.importStylesheet(o),p.transformToFragment(t,document)}function I(t,{namespace:n,qualifiedName:o,doctype:r}){const e=document.implementation.createDocument(n,o,r),l=(c,d)=>{for(const i in d)if(Object.hasOwn(d,i)){const u=d[i];if(typeof u=="object"&&u!==null){const a=e.createElement(i);l(a,u),c.appendChild(a)}else{const a=e.createElement(i);a.appendChild(e.createTextNode(String(u))),c.appendChild(a)}}};return l(e.documentElement,t),e}function f(t){return B.serializeToString(t)}document.getElementById("convert").addEventListener("click",X);async function X(){const{present:t,files:n}=w();if(!t){alert("Debes seleccionar todos los archivos.");return}try{const{claseFile:o,objetoFile:r,xsltFile:e}=n,l=await y(o),c=await y(r),d=await N(e),i={...l,...c};s.xml=I(i,{qualifiedName:"boardingpass"}),s.result=T(s.xml,d),m.textContent=f(s.xml),S.textContent=f(s.result),m.style.display="block",x.style.opacity=1,E.style.opacity=1,b(!1),h.addEventListener("click",()=>g("boardingpass.xml",s.xml)),L.addEventListener("click",()=>g("boardingpass.xml",s.result))}catch(o){alert("Error: "+o.message)}}function y(t){return new Promise((n,o)=>{const r=new FileReader;r.onload=()=>{try{n(JSON.parse(r.result))}catch{o(new Error("El archivo JSON no es vÃ¡lido."))}},r.onerror=()=>o(new Error("No se pudo leer el archivo.")),r.readAsText(t)})}function N(t){return new Promise((n,o)=>{const r=new FileReader;r.onload=()=>n(r.result),r.onerror=()=>o(new Error("No se pudo leer el archivo.")),r.readAsText(t)})}function P(t,n,o){const r=new Blob([n],{type:o}),e=document.createElement("a");e.href=URL.createObjectURL(r),e.download=t,document.body.appendChild(e),e.click(),document.body.removeChild(e)}function g(t,n){P(t,f(n),"application/xml")}function b(t){h.disabled=t,L.disabled=t}const w=()=>{const t=document.getElementById("clase").files[0],n=document.getElementById("objeto").files[0],o=document.getElementById("xslt").files[0];return{present:t&&n&&o,files:{claseFile:t,objetoFile:n,xsltFile:o}}};
