(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const l of e)if(l.type==="childList")for(const s of l.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function o(e){const l={};return e.integrity&&(l.integrity=e.integrity),e.referrerPolicy&&(l.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?l.credentials="include":e.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(e){if(e.ep)return;e.ep=!0;const l=o(e);fetch(e.href,l)}})();const b=new DOMParser,m=new XSLTProcessor,w=new XMLSerializer,c={xml:null,result:null},y=document.getElementById("output");y.style.opacity=0;const F=document.querySelectorAll("input");F.forEach(t=>t.addEventListener("change",()=>{c.xml=null,c.result=null,y.style.opacity=0,E(!0)}));function v(t,n){const o=b.parseFromString(n,"application/xml");return m.importStylesheet(o),m.transformToFragment(t,document)}function L(t,{namespace:n,qualifiedName:o,doctype:r}){const e=document.implementation.createDocument(n,o,r),l=(s,d)=>{for(const a in d)if(Object.hasOwn(d,a)){const i=d[a];if(typeof i=="object"&&i!==null){const u=e.createElement(a);l(u,i),s.appendChild(u)}else{const u=e.createElement(a);u.appendChild(e.createTextNode(String(i))),s.appendChild(u)}}};return l(e.documentElement,t),e}function g(t){return w.serializeToString(t)}const h=document.getElementById("xml"),x=document.getElementById("xsltBtn");document.getElementById("convert").addEventListener("click",B);async function B(){const{present:t,files:n}=N();if(!t){alert("Debes seleccionar todos los archivos.");return}try{const{claseFile:o,objetoFile:r,xsltFile:e}=n,l=await f(o),s=await f(r),d=await O(e),a={...l,...s};c.xml=L(a,{qualifiedName:"boardingpass"}),c.result=v(c.xml,d);const i=document.getElementById("output");i.textContent=g(c.result),i.style.opacity=1,E(!1),h.addEventListener("click",()=>p("boardingpass.xml",c.xml)),x.addEventListener("click",()=>p("boardingpass.xml",c.result))}catch(o){alert("Error: "+o.message)}}function f(t){return new Promise((n,o)=>{const r=new FileReader;r.onload=()=>{try{n(JSON.parse(r.result))}catch{o(new Error("El archivo JSON no es vÃ¡lido."))}},r.onerror=()=>o(new Error("No se pudo leer el archivo.")),r.readAsText(t)})}function O(t){return new Promise((n,o)=>{const r=new FileReader;r.onload=()=>n(r.result),r.onerror=()=>o(new Error("No se pudo leer el archivo.")),r.readAsText(t)})}function S(t,n,o){const r=new Blob([n],{type:o}),e=document.createElement("a");e.href=URL.createObjectURL(r),e.download=t,document.body.appendChild(e),e.click(),document.body.removeChild(e)}function p(t,n){S(t,g(n),"application/xml")}function E(t){h.disabled=t,x.disabled=t}const N=()=>{const t=document.getElementById("clase").files[0],n=document.getElementById("objeto").files[0],o=document.getElementById("xslt").files[0];return{present:t&&n&&o,files:{claseFile:t,objetoFile:n,xsltFile:o}}};
